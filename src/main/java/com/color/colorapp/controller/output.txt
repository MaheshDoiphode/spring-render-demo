package com.color.colorapp.controller;

import com.color.colorapp.dto.BetPlacementDTO;
import com.color.colorapp.dto.RoundResultDTO;
import com.color.colorapp.service.FinanceService;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.http.ResponseEntity;
import org.springframework.web.bind.annotation.*;

@RestController
@RequestMapping("/finance")
public class FinanceController {

    @Autowired
    private FinanceService financeService;

    @PostMapping("/bet")
    public ResponseEntity<?> placeBet(@RequestBody BetPlacementDTO betDto) {
        try {
            financeService.placeBet(betDto);
            return ResponseEntity.ok("Bet placed successfully");
        } catch (Exception e) {
            return ResponseEntity.badRequest().body("Error placing bet");
        }
    }

    @PostMapping("/result")
    public ResponseEntity<?> declareRoundResult(@RequestBody RoundResultDTO resultDto) {
        try {
            financeService.declareRoundResult(resultDto);
            return ResponseEntity.ok("Round result declared successfully");
        } catch (Exception e) {
            return ResponseEntity.badRequest().body("Error declaring round result");
        }
    }

    // Add more endpoints if necessary
}






//package com.color.colorapp.controller;
//
//import org.springframework.http.ResponseEntity;
//import org.springframework.web.bind.annotation.*;
//
//@RestController
//@RequestMapping("/finance")
//public class FinanceController {
//
//    @PostMapping("/details")
//    public ResponseEntity<String> addBankDetails(@RequestBody Object bankDetailsDto) {
//        // Placeholder for adding bank details
//        return ResponseEntity.ok("Bank Details Okay");
//    }
//
//    @PostMapping("/recharge")
//    public ResponseEntity<String> rechargeAccount(@RequestBody Object rechargeDto) {
//        // Placeholder for account recharge
//        return ResponseEntity.ok("Recharge Okay");
//    }
//
//    @GetMapping("/balance")
//    public ResponseEntity<String> getBalance() {
//        // Placeholder for getting balance
//        return ResponseEntity.ok("Balance Okay");
//    }
//}
package com.color.colorapp.controller;

import com.color.colorapp.service.FinanceService;
import com.color.colorapp.service.GameService;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.http.ResponseEntity;
import org.springframework.scheduling.annotation.Scheduled;
import org.springframework.web.bind.annotation.*;

@RestController
@RequestMapping("/game")
public class GameController {

    @Autowired
    private GameService gameService;

    @PostMapping("/bet")
    public ResponseEntity<String> placeBet(@RequestBody Object betDto) {
        // Placeholder for placing a bet
        return ResponseEntity.ok("Bet Okay");
    }

    @GetMapping("/result")
    public ResponseEntity<String> getGameResult() {
        // Placeholder for getting game result
        return ResponseEntity.ok("Result Okay");
    }





    @Scheduled(fixedDelay = 150000) // 2.5 minutes
    public void manageGameClosure() {
        gameService.phase2(); // Close betting, generate random number, update balances, etc.
    }

    @Scheduled(fixedDelay = 180000) // 3 minutes
    public void startNewRound() {
        gameService.startNewBettingRound(); // Create and open a new round for betting
    }


}
package com.color.colorapp.controller;

import org.springframework.http.ResponseEntity;
import org.springframework.web.bind.annotation.*;

@RestController
@RequestMapping("/user")
public class UserController {

    @PostMapping("/register")
    public ResponseEntity<String> registerUser(@RequestBody Object userDto) {
        // Placeholder for registration logic
        return ResponseEntity.ok("Registration Okay");
    }

    @PostMapping("/login")
    public ResponseEntity<String> loginUser(@RequestBody Object loginDto) {
        // Placeholder for login logic
        return ResponseEntity.ok("Login Okay");
    }
}
